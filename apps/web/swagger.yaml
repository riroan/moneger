openapi: 3.0.3
info:
  title: Moneger API
  description: ê°€ê³„ë¶€ ì„œë¹„ìŠ¤ Monegerì˜ REST API ë¬¸ì„œ
  version: 1.0.0
  contact:
    name: Moneger Team

servers:
  - url: http://localhost:3000
    description: ë¡œì»¬ ê°œë°œ ì„œë²„
  - url: https://moneger.vercel.app
    description: í”„ë¡œë•ì…˜ ì„œë²„

tags:
  - name: Auth
    description: ì¸ì¦ ê´€ë ¨ API
  - name: Transactions
    description: ê±°ë˜ ê´€ë ¨ API
  - name: Categories
    description: ì¹´í…Œê³ ë¦¬ ê´€ë ¨ API
  - name: Budgets
    description: ì˜ˆì‚° ê´€ë ¨ API
  - name: Savings
    description: ì €ì¶• ëª©í‘œ ê´€ë ¨ API
  - name: Stats
    description: í†µê³„ ê´€ë ¨ API

paths:
  # ==================== Auth ====================
  /api/auth/signup:
    post:
      tags: [Auth]
      summary: íšŒì›ê°€ì…
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                  example: user@example.com
                password:
                  type: string
                  minLength: 6
                  example: password123
                name:
                  type: string
                  example: í™ê¸¸ë™
      responses:
        '201':
          description: íšŒì›ê°€ì… ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼

  /api/auth/login:
    post:
      tags: [Auth]
      summary: ë¡œê·¸ì¸
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        '200':
          description: ë¡œê·¸ì¸ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨

  /api/auth/password:
    post:
      tags: [Auth]
      summary: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, currentPassword, newPassword]
              properties:
                userId:
                  type: string
                currentPassword:
                  type: string
                newPassword:
                  type: string
                  minLength: 6
      responses:
        '200':
          description: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„±ê³µ
        '401':
          description: í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜

  /api/auth/delete:
    delete:
      tags: [Auth]
      summary: íšŒì› íƒˆí‡´
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: íšŒì› íƒˆí‡´ ì„±ê³µ

  # ==================== Transactions ====================
  /api/transactions:
    get:
      tags: [Transactions]
      summary: ê±°ë˜ ëª©ë¡ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: year
          in: query
          schema:
            type: integer
          example: 2026
        - name: month
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 12
          example: 1
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/TransactionType'
        - name: categoryId
          in: query
          schema:
            type: array
            items:
              type: string
        - name: search
          in: query
          schema:
            type: string
          description: ì„¤ëª… ê²€ìƒ‰ì–´
        - name: sort
          in: query
          schema:
            type: string
            enum: [recent, oldest, expensive, cheapest]
            default: recent
        - name: cursor
          in: query
          schema:
            type: string
          description: í˜ì´ì§€ë„¤ì´ì…˜ ì»¤ì„œ
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: startYear
          in: query
          schema:
            type: integer
        - name: startMonth
          in: query
          schema:
            type: integer
        - name: endYear
          in: query
          schema:
            type: integer
        - name: endMonth
          in: query
          schema:
            type: integer
        - name: minAmount
          in: query
          schema:
            type: integer
        - name: maxAmount
          in: query
          schema:
            type: integer
        - name: savingsOnly
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: ê±°ë˜ ëª©ë¡
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTransactions'

    post:
      tags: [Transactions]
      summary: ê±°ë˜ ìƒì„±
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, type, amount]
              properties:
                userId:
                  type: string
                type:
                  $ref: '#/components/schemas/TransactionType'
                amount:
                  type: number
                  minimum: 0
                  example: 50000
                description:
                  type: string
                  example: ì ì‹¬ ì‹ì‚¬
                categoryId:
                  type: string
                date:
                  type: string
                  format: date-time
      responses:
        '201':
          description: ê±°ë˜ ìƒì„± ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionResponse'

  /api/transactions/{id}:
    get:
      tags: [Transactions]
      summary: ê±°ë˜ ìƒì„¸ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/transactionId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ê±°ë˜ ìƒì„¸
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionResponse'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags: [Transactions]
      summary: ê±°ë˜ ìˆ˜ì •
      parameters:
        - $ref: '#/components/parameters/transactionId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
                amount:
                  type: number
                description:
                  type: string
                categoryId:
                  type: string
                date:
                  type: string
                  format: date-time
      responses:
        '200':
          description: ê±°ë˜ ìˆ˜ì • ì„±ê³µ

    delete:
      tags: [Transactions]
      summary: ê±°ë˜ ì‚­ì œ
      parameters:
        - $ref: '#/components/parameters/transactionId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ê±°ë˜ ì‚­ì œ ì„±ê³µ

  /api/transactions/summary:
    get:
      tags: [Transactions]
      summary: ì›”ë³„ ê±°ë˜ ìš”ì•½ í†µê³„
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: month
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ê±°ë˜ ìš”ì•½
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionSummary'

  /api/transactions/recent:
    get:
      tags: [Transactions]
      summary: ìµœê·¼ ê±°ë˜ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: limit
          in: query
          schema:
            type: integer
            default: 5
      responses:
        '200':
          description: ìµœê·¼ ê±°ë˜ ëª©ë¡

  /api/transactions/today:
    get:
      tags: [Transactions]
      summary: ì˜¤ëŠ˜ ê±°ë˜ ìš”ì•½
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì˜¤ëŠ˜ ê±°ë˜ ìš”ì•½
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TodaySummary'

  /api/transactions/oldest-date:
    get:
      tags: [Transactions]
      summary: ê°€ì¥ ì˜¤ë˜ëœ ê±°ë˜ ë‚ ì§œ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ê°€ì¥ ì˜¤ë˜ëœ ê±°ë˜ ë‚ ì§œ

  # ==================== Categories ====================
  /api/categories:
    get:
      tags: [Categories]
      summary: ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/TransactionType'
      responses:
        '200':
          description: ì¹´í…Œê³ ë¦¬ ëª©ë¡
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Category'
                  count:
                    type: integer

    post:
      tags: [Categories]
      summary: ì¹´í…Œê³ ë¦¬ ìƒì„±
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, name, type]
              properties:
                userId:
                  type: string
                name:
                  type: string
                  example: ì‹ë¹„
                type:
                  $ref: '#/components/schemas/TransactionType'
                color:
                  type: string
                  example: '#10B981'
                icon:
                  type: string
                  example: ğŸ”
                defaultBudget:
                  type: number
                  example: 500000
      responses:
        '201':
          description: ì¹´í…Œê³ ë¦¬ ìƒì„± ì„±ê³µ
        '409':
          description: ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì¹´í…Œê³ ë¦¬

  /api/categories/{id}:
    get:
      tags: [Categories]
      summary: ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/categoryId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì¹´í…Œê³ ë¦¬ ìƒì„¸

    put:
      tags: [Categories]
      summary: ì¹´í…Œê³ ë¦¬ ìˆ˜ì •
      parameters:
        - $ref: '#/components/parameters/categoryId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
                name:
                  type: string
                color:
                  type: string
                icon:
                  type: string
                defaultBudget:
                  type: number
      responses:
        '200':
          description: ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì„±ê³µ

    delete:
      tags: [Categories]
      summary: ì¹´í…Œê³ ë¦¬ ì‚­ì œ
      parameters:
        - $ref: '#/components/parameters/categoryId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì„±ê³µ

  /api/categories/seed:
    post:
      tags: [Categories]
      summary: ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ìƒì„±
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        '201':
          description: ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ìƒì„± ì„±ê³µ

  # ==================== Budgets ====================
  /api/budgets:
    get:
      tags: [Budgets]
      summary: ì˜ˆì‚° ëª©ë¡ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: year
          in: query
          schema:
            type: integer
        - name: month
          in: query
          schema:
            type: integer
      responses:
        '200':
          description: ì˜ˆì‚° ëª©ë¡
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Budget'

    post:
      tags: [Budgets]
      summary: ì˜ˆì‚° ìƒì„±/ìˆ˜ì •
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, categoryId, amount, year, month]
              properties:
                userId:
                  type: string
                categoryId:
                  type: string
                amount:
                  type: number
                  minimum: 0
                  example: 500000
                year:
                  type: integer
                  example: 2026
                month:
                  type: integer
                  minimum: 1
                  maximum: 12
                  example: 1
      responses:
        '201':
          description: ì˜ˆì‚° ì €ì¥ ì„±ê³µ

    delete:
      tags: [Budgets]
      summary: ì˜ˆì‚° ì‚­ì œ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: categoryId
          in: query
          required: true
          schema:
            type: string
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: month
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ì˜ˆì‚° ì‚­ì œ ì„±ê³µ

  # ==================== Savings ====================
  /api/savings:
    get:
      tags: [Savings]
      summary: ì €ì¶• ëª©í‘œ ëª©ë¡ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì €ì¶• ëª©í‘œ ëª©ë¡
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SavingsGoal'

    post:
      tags: [Savings]
      summary: ì €ì¶• ëª©í‘œ ìƒì„±
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, name, icon, targetAmount, targetYear, targetMonth]
              properties:
                userId:
                  type: string
                name:
                  type: string
                  example: ì—¬í–‰ ìê¸ˆ
                icon:
                  type: string
                  example: âœˆï¸
                targetAmount:
                  type: number
                  example: 3000000
                currentAmount:
                  type: number
                  default: 0
                startYear:
                  type: integer
                startMonth:
                  type: integer
                targetYear:
                  type: integer
                  example: 2026
                targetMonth:
                  type: integer
                  example: 12
      responses:
        '201':
          description: ì €ì¶• ëª©í‘œ ìƒì„± ì„±ê³µ

  /api/savings/{id}:
    get:
      tags: [Savings]
      summary: ì €ì¶• ëª©í‘œ ìƒì„¸ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/savingsId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì €ì¶• ëª©í‘œ ìƒì„¸

    put:
      tags: [Savings]
      summary: ì €ì¶• ëª©í‘œ ìˆ˜ì •
      parameters:
        - $ref: '#/components/parameters/savingsId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
                name:
                  type: string
                icon:
                  type: string
                targetAmount:
                  type: number
                targetYear:
                  type: integer
                targetMonth:
                  type: integer
      responses:
        '200':
          description: ì €ì¶• ëª©í‘œ ìˆ˜ì • ì„±ê³µ

    delete:
      tags: [Savings]
      summary: ì €ì¶• ëª©í‘œ ì‚­ì œ
      parameters:
        - $ref: '#/components/parameters/savingsId'
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì €ì¶• ëª©í‘œ ì‚­ì œ ì„±ê³µ

  /api/savings/{id}/deposit:
    post:
      tags: [Savings]
      summary: ì €ì¶• ì…ê¸ˆ
      parameters:
        - $ref: '#/components/parameters/savingsId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, amount]
              properties:
                userId:
                  type: string
                amount:
                  type: number
                  minimum: 0
                  example: 100000
      responses:
        '200':
          description: ì…ê¸ˆ ì„±ê³µ

  /api/savings/summary:
    get:
      tags: [Savings]
      summary: ì €ì¶• ìš”ì•½ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì €ì¶• ìš”ì•½

  # ==================== Stats ====================
  /api/stats:
    get:
      tags: [Stats]
      summary: ì „ì²´ í†µê³„ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: ì „ì²´ í†µê³„

  /api/daily-balance:
    get:
      tags: [Stats]
      summary: ì¼ë³„ ì”ì•¡ ì¡°íšŒ
      parameters:
        - $ref: '#/components/parameters/userId'
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: month
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ì¼ë³„ ì”ì•¡ ëª©ë¡

  /api/health:
    get:
      tags: [Stats]
      summary: ì„œë²„ ìƒíƒœ í™•ì¸
      responses:
        '200':
          description: ì„œë²„ ì •ìƒ

components:
  parameters:
    userId:
      name: userId
      in: query
      required: true
      schema:
        type: string
      description: ì‚¬ìš©ì ID

    transactionId:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: ê±°ë˜ ID

    categoryId:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: ì¹´í…Œê³ ë¦¬ ID

    savingsId:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: ì €ì¶• ëª©í‘œ ID

  schemas:
    TransactionType:
      type: string
      enum: [INCOME, EXPENSE]
      description: ê±°ë˜ ìœ í˜• (ìˆ˜ì…/ì§€ì¶œ)

    Transaction:
      type: object
      properties:
        id:
          type: string
        amount:
          type: number
        type:
          $ref: '#/components/schemas/TransactionType'
        description:
          type: string
          nullable: true
        date:
          type: string
          format: date-time
        categoryId:
          type: string
          nullable: true
        category:
          $ref: '#/components/schemas/CategorySummary'
        userId:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Category:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        type:
          $ref: '#/components/schemas/TransactionType'
        color:
          type: string
          nullable: true
        icon:
          type: string
          nullable: true
        defaultBudget:
          type: number
          nullable: true
        userId:
          type: string

    CategorySummary:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        type:
          $ref: '#/components/schemas/TransactionType'
        color:
          type: string
          nullable: true
        icon:
          type: string
          nullable: true

    Budget:
      type: object
      properties:
        id:
          type: string
        amount:
          type: number
        categoryId:
          type: string
          nullable: true
        month:
          type: string
          format: date-time
        category:
          $ref: '#/components/schemas/CategorySummary'

    SavingsGoal:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        icon:
          type: string
        targetAmount:
          type: number
        currentAmount:
          type: number
        progressPercent:
          type: number
        monthlyRequired:
          type: number
        monthlyTarget:
          type: number
        thisMonthSavings:
          type: number
        targetDate:
          type: string
        startYear:
          type: integer
        startMonth:
          type: integer
        targetYear:
          type: integer
        targetMonth:
          type: integer
        isPrimary:
          type: boolean

    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        name:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time

    AuthResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            user:
              $ref: '#/components/schemas/User'
        message:
          type: string

    TransactionResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/Transaction'
        message:
          type: string

    PaginatedTransactions:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        count:
          type: integer
        nextCursor:
          type: string
          nullable: true
        hasMore:
          type: boolean

    TransactionSummary:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            summary:
              type: object
              properties:
                totalIncome:
                  type: number
                totalExpense:
                  type: number
                totalSavings:
                  type: number
                netAmount:
                  type: number
                balance:
                  type: number
            categories:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                  name:
                    type: string
                  icon:
                    type: string
                  total:
                    type: number
                  count:
                    type: integer
                  budget:
                    type: number
                  budgetUsagePercent:
                    type: number
            transactionCount:
              type: object
              properties:
                income:
                  type: integer
                expense:
                  type: integer

    TodaySummary:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            date:
              type: string
            year:
              type: integer
            month:
              type: integer
            day:
              type: integer
            dayOfWeek:
              type: integer
            expense:
              type: object
              properties:
                total:
                  type: number
                count:
                  type: integer
            income:
              type: object
              properties:
                total:
                  type: number
                count:
                  type: integer
            savings:
              type: object
              properties:
                total:
                  type: number
                count:
                  type: integer

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string

  responses:
    BadRequest:
      description: ì˜ëª»ëœ ìš”ì²­
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    NotFound:
      description: ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    Unauthorized:
      description: ì¸ì¦ í•„ìš”
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
